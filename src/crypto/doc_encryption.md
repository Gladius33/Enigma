# Encryption Module - `src/crypto/encryption.rs`

## Overview

This module implements authenticated encryption using **ChaCha20-Poly1305 (AEAD)** via the `ring` library.  
It is used for encrypting messages, files, and other payloads securely with integrity verification.

---

## Features

- **Symmetric encryption** with 256-bit keys.
- **Authenticated encryption**: detects any modification or tampering.
- **Nonce management**: unique nonce generated internally per message (based on a secure random seed).
- **Supports additional data**: headers or context can be authenticated (not encrypted).
- **Safe API**: avoids key reuse, separates encryption and decryption clearly.

---

## Security Notes

- **Tag (MAC)** is automatically appended by the `encrypt()` function (16 bytes).
- **Nonce is unique per session**: generated by a secure 96-bit counter seeded randomly.
- **Decryption requires correct nonce and AAD**; else decryption fails.

---

## Usage

```rust
let key = [0u8; 32]; // should be securely generated
let mut engine = EncryptionEngine::new(&key)?;

let plaintext = b"hello world!";
let aad = b"context";

let ciphertext = engine.encrypt(plaintext, aad)?;
let nonce = ...; // must be the same nonce used to encrypt

let decrypted = engine.decrypt(&ciphertext, &nonce, aad)?;
The nonce should be stored or sent alongside the encrypted message (e.g. in headers).

Dependencies
ring::aead

ChaCha20-Poly1305 AEAD primitive

SystemRandom for initial nonce seed

Related Modules
ratchet.rs: provides forward secrecy and key rotation.

signature.rs: for asymmetric authentication and identity verification.
